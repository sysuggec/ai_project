# tdd

使用 Test-Driven Development (TDD) 方法开发功能。

## 使用方式

```
tdd <目标目录> <功能描述>
```

## 参数

- `目标目录`: 代码存放目录（如 `src/Services`）
- `功能描述`: 要开发的功能描述（如 `用户登录服务`）

## 执行步骤

1. **加载 TDD 技能**
   - 使用 `tdd-skill` 技能加载 TDD 工作流程指南

2. **分析需求**
   - 理解功能需求
   - 识别需要实现的核心功能点
   - 规划测试用例覆盖范围

3. **🔴 RED - 编写失败的测试**
   - 创建测试文件 `tests/<目标路径>/<类名>Test.php`
   - 编写描述预期行为的测试用例
   - 运行测试确认失败（正确的失败原因）

4. **🟢 GREEN - 编写最小实现**
   - 创建生产代码文件 `src/<目标路径>/<类名>.php`
   - 编写恰好让测试通过的最小代码
   - 运行测试确认通过

5. **🔵 REFACTOR - 重构优化**
   - 在保持测试通过的前提下优化代码
   - 提取接口、消除重复、改进命名
   - 运行测试确保重构安全

6. **循环迭代**
   - 对每个新功能或边界情况重复 RED-GREEN-REFACTOR 循环

## 示例

```
tdd src/Sorter 冒泡排序算法工具
tdd src/Services/UserService 用户认证服务
tdd src/Validators 表单验证器，支持邮箱和手机号
```

## 编码规范

开发过程中必须遵循：
- PHP 编码规范（PSR-1/PSR-2/PSR-4）
- 使用 `declare(strict_types=1);`
- 方法名使用 camelCase
- 类名使用 PascalCase
- 所有公共方法必须有测试覆盖

## 输出

在指定目录下创建：
```
src/<目标路径>/
├── <类名>.php          # 生产代码
└── <接口名>.php        # 接口定义（如需要）

tests/<目标路径>/
└── <类名>Test.php      # 测试文件
```

## TDD 原则

1. **测试先行**: 永远先写测试，再写实现
2. **最小实现**: 只写刚好让测试通过的代码
3. **快速反馈**: 每次修改后立即运行测试
4. **持续重构**: 在绿色状态下不断优化代码
