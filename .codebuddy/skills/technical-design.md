# 技术设计 Skill

## 角色定位

技术设计将业务需求转化为可执行的技术方案。

## 核心原则

1. **分层设计** - 清晰的分层架构
2. **高内聚低耦合** - 模块职责单一，接口清晰
3. **可扩展性** - 支持未来扩展
4. **性能考虑** - 考虑性能优化点
5. **安全优先** - 安全性必须考虑
6. **可测试性** - 设计易于测试的架构

## 设计方法

### 1. 领域驱动设计（DDD）

识别核心领域、子域、聚合根、实体、值对象。

### 2. RESTful API 设计原则

- 使用 HTTP 方法：GET（查询）、POST（创建）、PUT（更新）、DELETE（删除）
- 使用 HTTP 状态码：200（成功）、400（错误）、401（未认证）、404（未找到）
- 使用资源路径：/api/users、/api/users/:id
- 使用分页、排序、过滤：?page=1&limit=10&sort=name

### 3. 数据库设计

- 范式化：减少数据冗余
- 反范式化：提高查询性能
- 索引优化：提高查询速度
- 外键约束：保证数据一致性

### 4. 缓存策略

- 热点数据缓存
- API 响应缓存
- 查询结果缓存
- 缓存失效策略

## 技术方案文档结构

```markdown
# 技术方案: [功能名称]

## 1. 方案概述
### 1.1 设计目标
### 1.2 技术栈

## 2. 架构设计
### 2.1 系统架构图
### 2.2 组件设计

## 3. 数据库设计
### 3.1 ER 图
### 3.2 表结构
### 3.3 索引策略
### 3.4 数据迁移

## 4. API 设计
### 4.1 API 端点清单
### 4.2 API 详细设计
### 4.3 认证和授权

## 5. 技术选型
### 5.1 前端技术栈
### 5.2 后端技术栈
### 5.3 数据库
### 5.4 缓存
### 5.5 其他

## 6. 安全设计
### 6.1 密码安全
### 6.2 Token 安全
### 6.3 API 安全
### 6.4 数据安全

## 7. 性能优化
### 7.1 数据库优化
### 7.2 缓存策略
### 7.3 前端优化

## 8. 错误处理
### 8.1 错误分类
### 8.2 错误响应格式

## 9. 日志和监控
### 9.1 日志策略
### 9.2 监控指标

## 10. 部署方案
### 10.1 部署架构
### 10.2 环境变量
### 10.3 部署步骤

## 11. 技术风险
### 11.1 风险列表
### 11.2 缓解措施

## 12. 后续优化
### 12.1 短期优化
### 12.2 长期优化
```

## 设计检查清单

### 架构设计
- [ ] 架构清晰，分层明确
- [ ] 组件职责单一
- [ ] 接口设计合理
- [ ] 支持扩展

### 数据库设计
- [ ] 表结构合理
- [ ] 索引设计合理
- [ ] 外键约束正确
- [ ] 迁移脚本完整

### API 设计
- [ ] RESTful 规范
- [ ] 请求响应格式统一
- [ ] 错误码定义完整
- [ ] 认证授权机制完善

### 安全设计
- [ ] 密码加密
- [ ] Token 安全
- [ ] API 防护
- [ ] 数据保护

### 性能设计
- [ ] 数据库优化
- [ ] 缓存策略
- [ ] 前端优化

## 最佳实践

1. **从需求出发** - 技术方案必须满足需求文档中的所有需求
2. **渐进式设计** - 先设计核心功能，再设计辅助功能
3. **考虑可扩展性** - 预留扩展空间
4. **安全优先** - 安全性必须考虑
5. **性能考虑** - 设计阶段就考虑性能
6. **可测试性** - 设计易于测试的架构
7. **文档完整** - 文档要详细、准确

## 常见错误

### ❌ 避免的错误

1. **过度设计**
   - 错误：设计复杂的架构
   - 正确：简单实用，满足需求即可

2. **忽略安全**
   - 错误：没有考虑安全性
   - 正确：安全性必须考虑，不能事后补充

3. **忽视性能**
   - 错误：没有考虑性能
   - 正确：设计阶段就考虑性能优化

4. **接口不统一**
   - 错误：API 响应格式不统一
   - 正确：统一的响应格式和错误码

## 总结

好的技术方案是成功项目的基石。确保技术方案：

- ✅ 架构清晰，分层明确
- ✅ 数据库设计合理
- ✅ API 设计规范
- ✅ 技术选型合理
- ✅ 安全设计完善
- ✅ 性能优化考虑
- ✅ 风险评估准确
