# 任务拆分 Skill

## 角色定位

任务拆分将技术方案转化为可执行的开发任务。

## 核心原则

1. **粒度适中** - 每个任务可在 2-4 小时内完成
2. **依赖清晰** - 明确任务间的依赖关系
3. **可验收** - 每个任务有明确的验收标准
4. **独立测试** - 每个任务可独立测试
5. **优先级明确** - 按优先级排序

## 拆分方法

### 1. 按组件拆分

```
前端组件
  ├─ 页面组件
  ├─ 业务组件
  └─ 基础组件

后端组件
  ├─ Controller（接口层）
  ├─ Service（业务逻辑层）
  ├─ Repository（数据访问层）
  └─ Model（数据模型）
```

### 2. 按功能点拆分

```
用户认证功能
  ├─ 注册功能
  ├─ 登录功能
  ├─ 登出功能
  └─ 密码重置功能
```

### 3. 按依赖关系排序

```
基础设施 → 数据层 → 业务层 → 接口层 → 前端层
```

### 4. 按风险优先级排序

```
P0（必须）→ P1（应该）→ P2（可以）
```

## 任务定义格式

```markdown
#### T1.1: [任务名称]
- **文件**: [文件路径]
- **操作**: [具体操作]
- **预估时间**: [时间]
- **依赖**: [依赖任务]
- **风险**: [风险等级]
- **验收标准**:
  - [ ] 标准1
  - [ ] 标准2
```

## 任务状态

| 状态 | 符号 | 说明 |
|------|------|------|
| pending | `[ ]` | 待执行 |
| in_progress | `[>]` | 进行中 |
| completed | `[x]` | 已完成 |
| failed | `[!]` | 失败 |
| blocked | `[-]` | 被阻塞 |
| skipped | `[~]` | 已跳过 |

## 任务拆分示例

### 阶段1: 基础设施

#### T1.1: 创建数据库迁移文件
- **文件**: `migrations/001_create_users_table.sql`
- **操作**: 创建 users 表，包含 id, email, password_hash, name, created_at, updated_at 字段
- **预估时间**: 30 分钟
- **依赖**: 无
- **风险**: 低
- **验收标准**:
  - [ ] SQL 语句正确执行
  - [ ] 表结构符合设计文档
  - [ ] 索引创建成功

### 阶段2: 数据访问层

#### T2.1: 创建 User Model
- **文件**: `src/models/User.ts`
- **操作**: 定义 User Prisma Model
- **预估时间**: 1 小时
- **依赖**: T1.1
- **风险**: 低
- **验收标准**:
  - [ ] Model 定义正确
  - [ ] 字段类型匹配数据库
  - [ ] 关系定义正确（如有）

### 阶段3: 业务逻辑层

#### T3.1: 创建 AuthService
- **文件**: `src/services/AuthService.ts`
- **操作**: 实现认证服务，包含 hashPassword, authenticate, generateToken, verifyToken 等方法
- **预估时间**: 2 小时
- **依赖**: T2.1
- **风险**: 中
- **验收标准**:
  - [ ] 所有方法实现
  - [ ] 密码哈希正确（bcrypt）
  - [ ] Token 生成和验证正确（JWT）
  - [ ] 账户锁定逻辑正确

### 阶段4: 接口层

#### T4.1: 创建 AuthController
- **文件**: `src/controllers/AuthController.ts`
- **操作**: 实现认证控制器，包含 register, login, logout, refresh, forgotPassword, resetPassword 方法
- **预估时间**: 2 小时
- **依赖**: T3.1, T3.2
- **风险**: 中
- **验收标准**:
  - [ ] 所有接口方法实现
  - [ ] 请求验证正确
  - [ ] 响应格式统一
  - [ ] 错误处理正确

### 阶段5: 前端实现

#### T5.1: 创建登录页面
- **文件**: `src/pages/Login.tsx`
- **操作**: 实现登录页面 UI，包含邮箱、密码输入框和登录按钮
- **预估时间**: 2 小时
- **依赖**: 无
- **风险**: 低
- **验收标准**:
  - [ ] UI 符合设计稿
  - [ ] 表单验证正确
  - [ ] 错误提示显示正确

## 任务计划文档结构

```markdown
# 任务计划: [功能名称]

## 1. 计划概述
### 1.1 项目信息
### 1.2 目标
### 1.3 范围

## 2. 阶段划分
### 阶段1: 基础设施
### 阶段2: 数据访问层
### 阶段3: 业务逻辑层
### 阶段4: 接口层
### 阶段5: 前端实现

## 3. 任务依赖图
[任务依赖关系图]

## 4. 里程碑
[里程碑列表]

## 5. 风险与缓解措施
[风险列表]

## 6. 资源需求
### 6.1 人力资源
### 6.2 技术资源

## 7. 进度追踪
### 7.1 任务状态定义
### 7.2 当前进度
### 7.3 任务状态更新

## 8. 交付物
[交付物列表]

## 9. 验收标准
### 9.1 功能验收
### 9.2 性能验收
### 9.3 安全验收
### 9.4 测试验收

## 10. 后续计划
### 10.1 第一期（MVP）
### 10.2 第二期
### 10.3 第三期
```

## 拆分检查清单

### 任务粒度
- [ ] 每个任务可在 2-4 小时内完成
- [ ] 任务不相互依赖过多
- [ ] 任务可以独立测试

### 依赖关系
- [ ] 依赖关系清晰
- [ ] 没有循环依赖
- [ ] 关键路径明确

### 验收标准
- [ ] 每个任务有明确的验收标准
- [ ] 验收标准具体可测
- [ ] 验收标准完整

### 风险评估
- [ ] 识别了技术风险
- [ ] 评估了风险等级
- [ ] 制定了缓解措施

## 最佳实践

1. **粒度适中** - 任务太大难以完成，太小过于琐碎
2. **依赖清晰** - 明确任务间的依赖关系
3. **可验收** - 每个任务有明确的验收标准
4. **独立测试** - 每个任务可以独立测试
5. **优先级明确** - 按优先级排序，优先完成核心功能

## 常见错误

### ❌ 避免的错误

1. **任务太大**
   - 错误：一个任务需要 2 天完成
   - 正确：拆分为多个小任务，每个任务 2-4 小时

2. **依赖混乱**
   - 错误：任务间依赖关系混乱，有循环依赖
   - 正确：清晰的依赖关系，无循环依赖

3. **验收标准不明确**
   - 错误：验收标准模糊
   - 正确：具体的、可测的验收标准

## 总结

好的任务拆分是成功开发的关键。确保：

- ✅ 任务粒度适中（2-4 小时）
- ✅ 依赖关系清晰
- ✅ 验收标准明确
- ✅ 可独立测试
- ✅ 优先级明确
- ✅ 风险评估完整
